<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏</title>
    <link rel="icon" type="image/png" href="teleport.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <div class="control-panel">
            <div class="project-info-section">
                <h3>üéØ –¢–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç</h3>
                <div id="currentProjectInfo" class="current-project-info">
                    <p>–ü—Ä–æ–µ–∫—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω</p>
                </div>
                <button id="changeProjectBtn" class="btn btn-secondary" style="display: none;" onclick="showProjectModal()">
                    üîÑ –°–º–µ–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                </button>
                <button id="updateCacheBtn" class="btn btn-info" style="display: none;" onclick="forceUpdateCache()">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                </button>
                <button id="logoutBtn" class="btn btn-danger" onclick="logout()" style="margin-top: 10px; width: 100%;">
                    üö™ –í—ã–π—Ç–∏
                </button>
            </div>
            
            <div class="search-section">
                <h3>üîç –ü–æ–∏—Å–∫ –∞–¥—Ä–µ—Å–∞</h3>
                <div class="search-input">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞..."
                        autocomplete="off"
                    >
                    <button id="searchBtn">–ù–∞–π—Ç–∏</button>
                </div>
                
                <div id="searchResults" class="search-results" style="display: none;"></div>
            </div>
            
            <div class="route-section">
                <h3>üõ£Ô∏è –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
                <div class="route-inputs">
                    <input type="text" id="startPoint" placeholder="–û—Ç–∫—É–¥–∞...">
                    <input type="text" id="endPoint" placeholder="–ö—É–¥–∞...">
                    
                    <div class="route-buttons">
                        <button id="buildRouteBtn">
                            <span class="yandex-icon">üó∫Ô∏è</span>
                            –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
                        </button>
                        <button id="clearRouteBtn" class="clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                <div id="routeInfo" class="route-info" style="display: none;"></div>
                </div>
            </div>
        </div>
        
        <div id="map" class="map-container">
        </div>
        
        <div id="storeInfoPanel" class="store-info-panel">
            <div class="store-info-header">
                <h3>üè™ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞–≥–∞–∑–∏–Ω–µ</h3>
                <button id="closeStoreInfoBtn" class="close-btn">√ó</button>
            </div>
            <div class="store-info-content">
                <div class="store-header" id="storeHeader">
                    <div class="store-address" id="storeAddress">-</div>
                    <div class="store-tk" id="storeTk">-</div>
                    <div class="store-route-buttons">
                        <button id="setAsStartPoint" class="route-btn start-btn">–û—Ç–∫—É–¥–∞</button>
                        <button id="setAsEndPoint" class="route-btn end-btn">–ö—É–¥–∞</button>
                    </div>
                </div>
                <div class="store-details" id="storeDetails">
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>
    </div>

    <div id="projectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üéØ –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ –≥–æ—Ä–æ–¥</h2>
                <p>–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏ –≥–æ—Ä–æ–¥</p>
            </div>
            
            <div class="modal-body">
                <div class="selection-section">
                    <h3>üè™ –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç</h3>
                    <div class="project-grid">
                        <div class="project-card" data-project="lenta" onclick="selectProject('lenta')">
                            <div class="project-icon">üè™</div>
                            <div class="project-name">–õ–µ–Ω—Ç–∞</div>
                            <div class="project-description">–°–µ—Ç—å –≥–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–æ–≤</div>
                        </div>
                         <div class="project-card" data-project="lentaShtat" onclick="selectProject('lentaShtat')">
                            <div class="project-icon">üë•</div>
                            <div class="project-name">–õ–µ–Ω—Ç–∞ –®—Ç–∞—Ç</div>
                            <div class="project-description">–®—Ç–∞—Ç–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</div>
                        </div>
                        <div class="project-card" data-project="magnet" onclick="selectProject('magnet')">
                            <div class="project-icon">üß≤</div>
                            <div class="project-name">–ú–∞–≥–Ω–∏—Ç</div>
                            <div class="project-description">–°–µ—Ç—å –º–∞–≥–∞–∑–∏–Ω–æ–≤</div>
                        </div>
                        <div class="project-card" data-project="vkusvill" onclick="selectProject('vkusvill')">
                            <div class="project-icon">ü•¨</div>
                            <div class="project-name">–í–∫—É—Å–í–∏–ª–ª</div>
                            <div class="project-description">–ü—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è</div>
                        </div>
                    </div>
                </div>
                
                <div class="selection-section" id="citySelection" style="display: none;">
                    <h3 id="citySelectionTitle">üèôÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</h3>
                    <div class="city-search">
                        <input type="text" id="citySearchInput" placeholder="–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞...">
                    </div>
                    <div class="city-grid" id="cityGrid">
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="backToProjectBtn" class="btn btn-secondary" style="display: none;">‚Üê –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º</button>
                
                   <div class="project-mode-switch">
                       <button id="projectModeSwitch" class="btn btn-switch">
                           <span class="switch-text">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</span>
                       </button>
                   </div>
                
                <button id="continueBtn" class="btn btn-primary" disabled>–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="config-dynamic.js"></script>
    <script type="module" src="supabase-client.js"></script>
    <script src="script.js"></script>
</body>
</html>
